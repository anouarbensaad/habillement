
<div class="container-fluid">
	<div class="row">
		<!-- Menu De Gauche -->
		<div class="col-sm-1">
			<ul class="nav-gproS" >
				<!-- <li><a class="btn btn-action pull-right menuH"
					href="#/gc_vente">Facture</a></li>
				<li><a class="btn btn-action pull-right menuH"
					href="#/gc_vente">Devis</a></li>
				<li><a class="btn btn-action pull-right menuH"
					href="#/gc_vente">BL</a></li> -->
				<li class="active"><a class="btn btn-action pull-right menuH"
					href="#/gc_vente">BC</a></li>
			</ul>
		</div>
		<!-- Front -->
		<div class="col-sm-11 cadreERP" ng-controller="AchatCtrl">
			<!-- Critere de recherche -->
			<div class="panel-body" ng-show="displayMode != 'edit'">

				<div class="col-sm-12">
					<button class="btn btn-action2 pull-right"
						ng-click="AffectationAchatBC(commandeAchatCourante)"
						ng-disabled="">Ajouter</button>
				</div>

				<div class="title-ajout">Crit&eacute;res de recherche</div>
				<div class="panel panel-primary">
					<div class="panel-body">
						<form class="form-horizontal" id="rechercheSSForm"
							name="rechercheSSForm">
							<div class="form-group">
								<div class="row">
									<div class="col-sm-3">
										<div class="input-group input-group-sm">
											<span class="input-group-addon label1" id="basic-addon1">R&eacute;f&eacute;rence BC
											</span> <input type="text" class="form-control"
												ng-model="commandeAchatCourante.vReference">
										</div>
									</div>
									<div class="col-sm-3">
										<div class="input-group input-group-sm">
											<span class="input-group-addon label1" id="basic-addon1">Fournisseur
											</span> <select class="form-control"
												ng-model="commandeAchatCourante.vTypePartieInteressee">
												<option ng-repeat="client in ListClientCommandeAchatCache"
													value="{{client.id}}">{{client.abreviation}}</option>
											</select>
										</div>
									</div>
									<div class="col-sm-3" ng-controller="DatepickerDemoController">
										<div class="input-group input-group-sm">
											<span class="input-group-addon label1" id="basic-addon1">Date
												Cmd.Entre </span> <input type="text"
												class="form-control datepicker"
												datepicker-popup="{{format}}"
												ng-model="commandeAchatCourante.dateIntroductionDu"
												is-open="opened" datepicker-options="dateOptions"
												date-="enabled(date, mode)" ng-required="true"
												close-text="Close" />
											<div class="input-group-btn">
												<button type="button" class="btn btn-default"
													ng-click="open($event)">
													<i class="glyphicon glyphicon-calendar"></i>
												</button>
											</div>
										</div>
									</div>
									<div class="col-sm-3" ng-controller="DatepickerDemoController">
										<div class="input-group input-group-sm">
											<span class="input-group-addon label1" id="basic-addon1">Et
											</span> <input type="text" class="form-control datepicker"
												datepicker-popup="{{format}}"
												ng-model="commandeAchatCourante.dateIntroductionA"
												is-open="opened" datepicker-options="dateOptions"
												date-="enabled(date, mode)" ng-required="true"
												close-text="Close" />
											<div class="input-group-btn">
												<button type="button" class="btn btn-default"
													ng-click="open($event)">
													<i class="glyphicon glyphicon-calendar"></i>
												</button>
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class="form-group">
								<div class="row">
									<div class="col-sm-3" ng-controller="DatepickerDemoController">
										<div class="input-group input-group-sm">
											<span class="input-group-addon label1" id="basic-addon1">Date
												Liv.Prev.Entre </span> <input type="text"
												class="form-control datepicker"
												datepicker-popup="{{format}}"
												ng-model="commandeAchatCourante.dateIntroductionDu"
												is-open="opened" datepicker-options="dateOptions"
												date-="enabled(date, mode)" ng-required="true"
												close-text="Close" />
											<div class="input-group-btn">
												<button type="button" class="btn btn-default"
													ng-click="open($event)">
													<i class="glyphicon glyphicon-calendar"></i>
												</button>
											</div>
										</div>
									</div>
									<div class="col-sm-3" ng-controller="DatepickerDemoController">
										<div class="input-group input-group-sm">
											<span class="input-group-addon label1" id="basic-addon1">Et
											</span> <input type="text" class="form-control datepicker"
												datepicker-popup="{{format}}"
												ng-model="commandeAchatCourante.dateIntroductionA"
												is-open="opened" datepicker-options="dateOptions"
												date-="enabled(date, mode)" ng-required="true"
												close-text="Close" />
											<div class="input-group-btn">
												<button type="button" class="btn btn-default"
													ng-click="open($event)">
													<i class="glyphicon glyphicon-calendar"></i>
												</button>
											</div>
										</div>
									</div>
									<div class="col-sm-2">
										<div class="input-group input-group-sm">
											<span class="input-group-addon label1" id="basic-addon1">Cout
												</span> <select class="form-control"
												ng-model="commandeAchatCourante.vTypeCommande">
												<option value=">">></option>
												<option value=">"><</option>
												<option value=">">=</option>
												<option value=">">>=</option>
												<option value=">"><=</option>
											</select>
										</div>
									</div>
									<div class="col-sm-1">
										<div class="input-group input-group-sm">
											<input type="text" class="form-control"
												ng-model="commandeAchatCourante.vReference">
										</div>
									</div>
									<div class="col-sm-3">
										<div class="input-group input-group-sm">
											<span class="input-group-addon label1" id="basic-addon1">Etat</span>
											<select class="form-control"
												ng-model="commandeAchatCourante.vEtatCommande">
												<option>Livré</option>
												<option>Non Livré</option>
												<option>Partiellement Livré</option>
											</select>
										</div>
									</div>
								</div>
							</div>
							<div class="form-group">
								<div class="row">
									<div class="col-sm-3">
										<div class="input-group">
											<span class="input-group-addon label1" id="basic-addon1">Site</span>
											<select class="form-control" ng-model="commandeAchatCourante.site">
												<option ng-repeat="site in listeSitePartieInteresseeCache"
													value="{{site.id}}">{{site.nom}}</option>
											</select>
										</div>
									</div>
								</div>
							</div>
						</form>
						<div class="pull-right">
							<button class="btn-action btn">G&eacute;n&eacute;rer</button>
							<button class="btn-action btn"
								ng-click="rechercherCommandeAchat(commandeAchatCourante)">Recherecher</button>
							<button class="btn-action btn" ng-click="annulerAjout()">Annuler</button>
						</div>
					</div>
				</div>
			</div>

			<!-- container d'ajout,  modification et de consultation Gestion Commerciale BC Achat-->
			<div class="panel-body" ng-show="displayMode == 'edit'">
				<div class="col-sm-12">
					<div class="pull-right">
						<button class="btn btn-action"
							ng-click="sauvegarderAjout(commandeAchatCourante)" ng-disabled="">Enregistrer</button>
						<button class="btn-action btn">G&eacute;n&eacute;rer</button>
						<button class="btn btn-action" ng-click="annulerAjout()">Retour</button>
					</div>
				</div>
				<div class="col-md-12">
					<div class="title-ajout">Bon Commande</div>
					<div class="panel panel-primary">
						<div class="panel-body">
							<form name="creationSSForm">
								<div class="form-group">
									<div class="row">
										<div class="col-sm-3">
											<div class="input-group input-group-sm">
												<span class="input-group-addon label1" id="basic-addon1">R&eacute;f&eacute;rence
												</span> <input type="text" class="form-control"
													ng-model="commandeAchatCourante.reference">
											</div>
										</div>
										<div class="col-sm-3">
											<div class="input-group input-group-sm">
												<span class="input-group-addon label1" id="basic-addon1">Fournisseur
												</span>
												<ul ng-repeat="client in ListClientCommandeAchatCache"></ul>
												<select class="form-control"
													ng-model="commandeAchatCourante.partieIntersseId">
													<option ng-repeat="client in ListClientCommandeAchatCache"
														value="{{client.id}}">{{client.abreviation}}</option>
												</select>
											</div>
										</div>
										<div class="col-sm-3" ng-controller="DatepickerDemoController">
											<div class="input-group input-group-sm">
												<span class="input-group-addon label1" id="basic-addon1">Date
													Commande</span> <input type="text" class="form-control datepicker"
													datepicker-popup="{{format}}"
													ng-model="commandeAchatCourante.dateCommande"
													is-open="opened" datepicker-options="dateOptions"
													date-="enabled(date, mode)" ng-required="true"
													close-text="Close" />
												<div class="input-group-btn">
													<button type="button" class="btn btn-default"
														ng-click="open($event)">
														<i class="glyphicon glyphicon-calendar"></i>
													</button>
												</div>
											</div>
										</div>
										<div class="col-sm-3" ng-controller="DatepickerDemoController">
											<div class="input-group input-group-sm">
												<span class="input-group-addon label1" id="basic-addon1">Date
													Livraison</span> <input type="text"
													class="form-control datepicker"
													datepicker-popup="{{format}}"
													ng-model="commandeAchatCourante.dateLivraisonPrevue"
													is-open="opened" datepicker-options="dateOptions"
													date-="enabled(date, mode)" ng-required="true"
													close-text="Close" />
												<div class="input-group-btn">
													<button type="button" class="btn btn-default"
														ng-click="open($event)">
														<i class="glyphicon glyphicon-calendar"></i>
													</button>
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="form-group">
									<div class="row">
										<div class="col-sm-3">
											<div class="input-group input-group-sm">
												<span class="input-group-addon label1" id="basic-addon1">Site
												</span> <select class="form-control"
													ng-model="commandeAchatCourante.siteId">
													<option ng-repeat="site in listeSitePartieInteresseeCache"
														value="{{site.id}}">{{site.nom}}</option>
												</select>
											</div>
										</div>
										<div class="col-sm-3">
											<div class="input-group input-group-sm">
												<span class="input-group-addon label1" id="basic-addon1">Etat</span>
												<select class="form-control"
													ng-model="commandeAchatCourante.etat">
													<option>Livré</option>
													<option>Non Livré</option>
													<option>Partiellement Livré</option>
												</select>
											</div>
										</div>
										<div class="col-sm-3">
											<div class="input-group input-group-sm">
												<span class="input-group-addon label1" id="basic-addon1">Co&ucirc;t
													Total </span> <input type="text" class="form-control"
													ng-model="commandeAchatCourante.coutTotal" disabled>
											</div>
										</div>
									</div>
								</div>
								<div class="form-group">
									<div class="row">
										<div class="col-sm-6">
											<div class="input-group input-group-sm">
												<span class="input-group-addon label1" id="basic-addon1">Observations</span>
												<textarea class="form-control"
													ng-model="commandeAchatCourante.observations" rows="4"></textarea>
											</div>
										</div>
									</div>
								</div>
							</form>
						</div>
					</div>
					<!-- Elements Liste -->
					<div class="title-ajout line">Article</div>
					<div class="spacerR">
										<button class="btn btn-action pull-right "
											ng-click="showPopupDelete(14)">Rechercher</button>
									</div>
					<div class="panel-body">
						<div class="form-group">
							<div class="row">
								<div class="panel panel-primary">
									<table
										class="table table-bordered table-condensed table-head-color">
										<thead>
											<tr>
												<th style="width: 10%">R&eacute;f.Article</th>
												<th style="width: 10%">Article</th>
												<th style="width: 10%">Type</th>
												<th style="width: 10%">Famille</th>
												<th style="width: 10%">Sous Famille</th>
												<th style="width: 10%">Quantit&eacute;</th>
												<th style="width: 10%">Unite</th>
												<th style="width: 10%">Prix Unitaire</th>
												<th style="width: 10%">Prix Total</th>
												<th style="width: 5%">Livré</th>
												<th></th>
											</tr>
										</thead>
										<tbody>
											<tr ng-repeat="elementCmd in listElementCommande">
												<td>*REF: articleId</td>
												<td>*DESIGNATION</td>
												<td>*TYPE</td>
												<td>*FAMILLE</td>
												<td>*SOUSFAMILLE</td>
												<td>{{elementCmd.quantite}}</td>
												<td>UNITE</td>
												<td>{{elementCmd.prixUnitiaire}}</td>
												<td>{{elementCmd.prixTotal}}</td>
												<td>{{elementCmd.livre}}</td>
												<td style="white-space: nowrap">
													<!-- form -->
													<form editable-form name="rowform"
														onbeforesave="saveElement($data, elementCmd.id)"
														ng-show="rowform.$visible"
														class="form-buttons form-inline"
														shown="elementCmdInserree == elementCmd">
														<button type="submit" ng-disabled="rowform.$waiting"
															class="btn btn-sm glyphicon glyphicon-save"
															aria-hidden="true"></button>
														<button type="button" ng-disabled="rowform.$waiting"
															ng-click="cancelAddCommandeAchat(rowform, $index,  elementCmd.id, elementCmd.elementCmdId, listElementCommande )"
															class="btn btn-sm glyphicon glyphicon-remove"></button>
													</form>
													<div class="buttons" ng-show="!rowform.$visible">
														<button data-nodrag
															class="btn btn-sm glyphicon glyphicon-pencil"
															ng-click="rowform.$show();showBC()"></button>
														<button data-nodrag
															class="btn btn-sm glyphicon glyphicon-trash"
															ng-click="removeElement($index)"></button>
													</div>
												</td>
											</tr>
									</table>
									<button class="btn btn-action pull-right spacer2"
										ng-click="ajoutElement()">Ajouter</button>

								</div>

							</div>
						</div>
					</div>
					<!-- Documents -->
					<div class="title-ajout">Documents</div>
					<div class="panel-body" ng-show="displayMode == 'edit'">
						<div class="form-group">
							<div class="row">
								<div class="panel panel-primary">
									<table
										class="table table-bordered table-condensed table-head-color">
										<thead>
											<tr>
												<th class="hidden" style="width: 10%">Id</th>
												<th style="width: 30%">Type Document</th>
												<th style="width: 40%">Document</th>
												<th style="width: 20%"></th>
											</tr>
										</thead>
										<tbody>
											<tr
												ng-repeat="documentCommandeAchat in listeDocumentCommandeAchat">
												<td class="hidden">
													<!-- editable documentCommandeAchat (text with validation) -->
													<span editable-text="documentCommandeAchat.id" e-name="id"
													e-form="rowform" e-required> {{
														documentCommandeAchat.id || 'empty' }} </span>
												</td>
												<td>
													<!-- editable group (select-remote) --> <span
													editable-select="documentCommandeAchat.typeDocumentId"
													e-ng-options="s.id as s.designation for s in ListTypeDocumentCache"
													e-name="idTypeDocPI" e-form="rowform">
														{{showStatus(documentCommandeAchat.typeDocumentId) }} </span>
												</td>
												<td ng-controller="UploadCtrlCommandeAchat">
													<!-- Upload Document File -->
													<div class="form-group">
														<div class="col-sm-12">
															<div class="fileinput fileinput-new"
																data-provides="fileinput">
																<input class="hidden" type="text" ng-model="name" /> <span
																	class="btn btn-file btn-sm" style="background: #e6e9ee"
																	ng-show="!isUploaded && rowform.$visible"> <span
																	class="fileinput-new">Selectionner fichier</span> <input
																	type="file" class="custom-file-input"
																	file-model="myFile"> <span href="#"
																	class="close fileinput-exists pull-right"
																	style="float: none; padding: 0"
																	data-dismiss="fileinput"
																	ng-show="!isUploaded && rowform.$visible">x</span>
																</span> <span class="fileinput-filename"
																	ng-model="documentCommandeAchat.path" e-name="path"
																	e-form="rowform" e-required>{{documentCommandeAchat.path}}</span>
															</div>
															<a class="btn btn-danger btn-sm pull-right"
																ng-click="downloadFileCommandeAchat(documentCommandeAchat.uidDocument)"
																ng-href="{{urlFile}}" ng-show="!rowform.$visible"> <span
																class="glyphicon glyphicon-cloud-download"></span>
															</a> <a ng-click="uploadFileCommandeAchat()"
																ng-show="!isUploaded && rowform.$visible"
																class="btn btn-info btn-sm fileinput-upload glyphicon glyphicon-cloud-upload pull-right">
															</a> <a class="btn btn-success btn-sm pull-right"
																href="E:/archive/{{documentCommandeAchat.uidDocument}}/{{documentCommandeAchat.path}}"
																ng-show="!rowform.$visible"> <span
																class="glyphicon glyphicon-cloud-download"></span>
															</a>
														</div>
													</div> <input class="hidden"
													ng-model="documentCommandeAchat.uidDocument"
													e-name="uidDocument" e-form="rowform" e-required
													value="{{ documentCommandeAchat.uidDocument ||
															'empty' }} " />
												</td>
												<td style="white-space: nowrap">
													<!-- form -->
													<form editable-form name="rowform"
														onbeforesave="saveDocumentCommandeAchat($data, documentCommandeAchat.id)"
														ng-show="rowform.$visible"
														class="form-buttons form-inline"
														shown="documentCommandeAchatInserree == documentCommandeAchat">
														<button type="submit" ng-disabled="rowform.$waiting"
															class="btn btn-sm glyphicon glyphicon-save"
															aria-hidden="true"></button>
														<button type="button" ng-disabled="rowform.$waiting"
															ng-click="cancelAddCommandeAchat(rowform, $index, documentCommandeAchat.id, documentCommandeAchat.typeDocumentId, listeDocumentCommandeAchat )"
															class="btn btn-sm glyphicon glyphicon-remove"></button>
													</form>
													<div class="buttons" ng-show="!rowform.$visible">
														<button data-nodrag
															class="btn btn-sm glyphicon glyphicon-pencil"
															ng-click="rowform.$show()"></button>
														<button data-nodrag
															class="btn btn-sm glyphicon glyphicon-trash"
															ng-click="removeDocumentCommandeAchat($index)"></button>
													</div>
												</td>
											</tr>

										</tbody>
									</table>
									<button class="btn btn-action pull-right spacer2"
										ng-click="ajoutDocumentCommandeAchat()">Ajouter</button>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="panel-body" ng-show="displayMode != 'edit'">
				<div class="col-md-12">
					<div class="title-ajout line">Liste des Bons de Commande</div>
					<div style="height: 500px;" ng-grid="gridOptions"></div>
				</div>
			</div>
		</div>
	</div>
</div>